{% load static %}

{% if models %}
    {% if has_user %}
        <form>
    {% endif %}
<div class="table-container">
    <table id="leaderboard" class="table is-hoverable benchmarks fixed_header">
        <! Each of the cells in table/heading have a lot of information of what benchmark they are and who their
        parent is. This allows for QuerySelecting and using some of the filters from index.py>
        <thead>
        <tr>
            <th id="model-th" class="model want_to_click"><p>
            <span class="identifier want_to_click">
                Model
            </span>
            </p></th>
            {% for benchmark in benchmarks %}
                <th
                        {% if benchmark.ceiling and benchmark.ceiling != 'X' %}
                            title="ceiling: {{ benchmark.ceiling }}"
                        {% endif %}
                            data-benchmark="{{ benchmark.short_name }}"
                            data-parent="{{ benchmark_parents|get_parent_item:benchmark.identifier }}"
                            class="rotate depth_{{ benchmark.depth }}"
                >
                    <p>
                        {% if benchmark.benchmark_type.parent %}
                            {# indent, depending on depth #}
                            <span class="want_to_click benchmark_child_indent">
                            {{ benchmark_parents|get_initial_characters:benchmark.identifier }}
                        </span>
                        {% endif %}

                        {# reference link #}
                        {% if benchmark.benchmark_type.reference and benchmark.benchmark_type.reference.url %}
                            <a href="{{ benchmark.benchmark_type.reference.url }}">
                        {% endif %}

                        {# identifier #}
                        <span data-benchmark="{{ benchmark.short_name }}"
                              class="want_to_click clicker depth_{{ benchmark.depth }}
                                   {% if benchmark.version %} instance {% endif %}
                                   {% if benchmark.root_parent == 'average_{{ domain }}' %} brain_benchmark {% endif %}"
                              value="{{ benchmark.identifier }}">{{ benchmark.short_name|simplify_domain }}
                        </span>
                        {% if benchmark.benchmark_type.reference and benchmark.benchmark_type.reference.url %}
                            </a>
                        {% endif %}
                    </p></th>
            {% endfor %}
        </tr>
        </thead>
        <!-- models -->
        <tbody>
        <tr>
            <td class="model">
                <div class="identifier">
                    Average model scores
                </div>
            </td>
            {% for score_row in model.scores %}
                <td title="{{ score_row.benchmark.short_name }} unceiled: {{ score_row.score_raw|format_score }}"
                    data-benchmark="{{ score_row.versioned_benchmark_identifier }}"
                    data-parent="{{ benchmark_parents|get_parent_item:score_row.versioned_benchmark_identifier }}"
                    class="score_cell displaySquare depth_{{ score_row.benchmark.depth }} clicker"
                    style="{{ score_row.color }}">
                    {{ score_row.score_ceiled }}
                </td>
            {% endfor %}
        </tr>
        {% for model in models %}
            <tr>
                <td class="model">
                    <div class="identifier" title="{{ model.reference_identifier }}">

                        <a target="_self" rel="noopener noreferrer" href="{% url 'model-view' domain model.id %}">
                            {{ model|display_model:user }}
                        </a>
                    </div>
                </td>
                {% for score_row in model.scores %}
                    <td title="{{ score_row.benchmark.short_name }} unceiled: {{ score_row.score_raw|format_score }}"
                        data-benchmark="{{ score_row.versioned_benchmark_identifier }}"
                        data-parent="{{ benchmark_parents|get_parent_item:score_row.versioned_benchmark_identifier }}"
                        class="score_cell displaySquare depth_{{ score_row.benchmark.depth }} clicker"
                        style="{{ score_row.color }}">
                        {{ score_row.score_ceiled }}
                    </td>
                {% endfor %}
            </tr>
        {% endfor %}
        </tbody>
    </table>
</div>

<div class="column is-10">
    Model scores on brain benchmarks.
    Click on a model to see more details.
    The more green and bright a cell, the better the model's score.
    Scores are ceiled, hover the benchmark to see ceilings.
</div>
{% if has_user %}
    </form>
{% endif %}
{% else %}
    <p>No data.</p>
{% endif %}
