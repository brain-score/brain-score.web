{% extends "benchmarks/components/app-view.html" %}
{% load static %}

{% block banner %}
<h1>Deep Dive 1</h1>
<p>A Tour of the Submission Package </p>
{% endblock %}

{% block info_section %}
  {% include "benchmarks/tutorials/tutorial-info-section.html" %}
{% endblock %}


{% block content %}

<div class="box leaderboard-table-component">
    <div class="columns is-tablet is-variable is-1-tablet">
        <div class="column is-one-half">
            <img class="tutorial_dd1_1" src="{% static "/benchmarks/img/tutorials/deep_dive_1_1.png" %}" />
        </div>
        <div class="column is-one-half tutorial_text">
            <h3 class="benefits_heading is-size-3-mobile">Let's Dive Deeper!</h3>
            <p class="benefits_info is-size-5-mobile">
                One of the biggest benefits Brain-Score has to offer is integrative benchmarking, in which
                a user can submit a model and see how it performs on many benchmarks, not just a single one.
                Oftentimes this leads to new insights and correlations, as well as interesting findings.
            </p>
            <p class="benefits_info is-size-5-mobile">
                In this first Deep Dive, we will download a sample Brain-Score submission (containing the model ResNet-50),
                and explore the parts of its submission package. You can then base your own unique submissions on our sample project.
            </p>

            <p class="benefits_info is-size-5-mobile is-italic">
                Note: Please do not submit the tutorial file itself via the website. The following walkthough is just
                to let you become familiar with how submissions should be structured.
            </p>
        </div>
    </div>
</div>

<div class="box leaderboard-table-component">
    <div class="columns is-tablet is-variable is-1-tablet">
        <div class="column is-one-half tutorial_text_dd1">
            <h3 class="benefits_heading is-size-3-mobile">Part 1: Install Necessary Packages</h3>
            <p class="benefits_info is-size-5-mobile">
                If you have not already, we highly recommend completing the Quickstart section above before
                we start to explore our ResNet-50 model submission package. Although completion is not
                required, the Quickstart will give you a nice background into what model scores mean, and how to score a model
                locally on a single, publicly available benchmark.
            </p>
            <p class="benefits_info is-size-5-mobile">
                If you have already done the Quickstart,
                skip to step 2 to the right. Otherwise, visit please <a href="https://www.brain-score.org/tutorial/quickstart">here</a>
                to install the necessary packages for Brain-Score.
            </p>
        </div>
        <div class="column is-one-half tutorial_text_dd1">
            <h3 class="benefits_heading is-size-3-mobile">Part 2: Download the Starter Zip File:</h3>
            <p class="benefits_info is-size-5-mobile">
                Brain-Score allows users to submit plugins in two ways: directly to the site, via a Zip file
                upload, or through a Github PR. In this first Deep Dive, you will explore a sample model submission
                in order to become familiar with the submission package structure. You can download the sample zip file
                <a href="{% static "/benchmarks/packaging_tutorial.zip" %}" download="packaging_tutorial.zip">here</a>.
                The sample Zip file contains a properly formatted, stock version of ResNet-50 pretrained on ImageNet.
            </p>
             <p class="benefits_info is-size-5-mobile">
                In Deep Dives 2 and 3, we will look at a custom model submission, as well as prepare to submit a
                 model via Github Pull Request respectively.
            </p>
        </div>
    </div>
</div>

<div class="box leaderboard-table-component">
    <h3 class="benefits_heading is-size-3-mobile">Part 3: Exploring the Starter Submission File</h3>
    <p class="benefits_info is-size-5-mobile shorter">
        After unzipping the <span class="special_format">packaging_submission.zip</span> file, you will see that the root folder is
        called <span class="special_format">packaging_tutorial</span>. This in turns contains another folder for the plugin itself, in
        this case <span class="special_format">/models</span>. This <span class="special_format">/models</span> folder then
        contains a folder called <span class="special_format"> /resnet50_tutorial</span>.
        This final also contains 4 other Python files. The overall structure of the submission
        package is shown below:
    </p>
    <img class="submission example" width="500" height="auto" src="{% static "/benchmarks/img/submission_structure.png" %}" />
    <p class="benefits_info is-size-5-mobile shorter">
        Just like the sample submission, each submission that you submit must contain at least the 2 required
        Python files: <span class="special_format">__init__.py</span> and <span class="special_format">test.py</span>.
        The other two files, <span class="special_format">setup.py</span> and <span class="special_format">model.py</span>,
        are optional, but will be explored below along with the two required files. Let's explore further with the first required file,
        <span class="special_format">__init__.py</span> file.
    </p>
    <p class="benefits_info is-size-5-mobile shorter is-italic">
        Note: this would also be the same overall structure as your submission
        package, or if you are submitting any other plugins (benchmarks, metrics, or data). Feel free
        to base your future submissions off of this package, just please do not submit the
    <span class="special_format">resnet50_tutorial</span> model.
    </p>
</div>

<div class="box leaderboard-table-component">
    <h3 class="benefits_heading is-size-3-mobile">Part 4: Exploring the  __init__.py  file</h3>
    <p class="benefits_info is-size-5-mobile shorter">
        This file adds your plugin to the Brain-Score plugin registry and to the Brain-Score
        ecosystem at large. You are registering your model to a unique global identifier. You can
        see that this file is fairly straightforward. Lines 1-3 are standard imports, and line 5
        adds the plugin to the registry. In the future, when you submit models (or other plugins),
        you will add the plugin to our ecosystem via line 5.
    </p>

    <pre class="modified_1"><code>
from brainscore_vision import model_registry
from brainscore_vision.model_helpers.brain_transformation import ModelCommitment
from .model import get_model, get_layers

model_registry['resnet50'] = lambda: ModelCommitment(identifier='resnet50', activations_model=get_model('resnet50'), layers=get_layers('resnet50'))
    </code></pre>
    <p class="benefits_info is-size-5-mobile shorter">
        Please note: Brain-Score does not allow duplicate plugin
        names, so if you submit another version of the same model, make sure to make the identifier unique!
    </p>
    <p class="benefits_info is-size-5-mobile shorter">
        Also note: It would be prohibitively time- and resource-consuming to actually load every plugin
        in a registry before they are needed, so the plugin discovery process relies on string parsing.
        This unfortunately means that it’s not possible to programmatically add plugin identifiers to
        the registry; each registration needs to be written explicitly in the form of
        <span class="special_format">plugin_registry['my_plugin_identifier']</span>
        Next, let’s check out the second required file, <span class="special_format">test.py</span> file.
    </p>
</div>



<!--            </p>-->
<!--        </div>-->
<!--    </div>-->
<!--</div>-->

<!--            <div class="columns is-centered">-->
<!--                <div class="column is-three-quarters has-text-centered">-->
<!--                    <h3 class="benefits_heading is-size-3-mobile">Part 4: Explore the  __init__.py  file: </h3>-->



<!--                    </p>-->
<!--                </div>-->
<!--            </div>-->

<!--            <div class="columns is-centered">-->
<!--                <div class="column is-three-quarters has-text-centered">-->
<!--                    <h3 class="benefits_heading is-size-3-mobile">Part 5: The test.py file:  </h3>-->
<!--                       <p>Currenlty, this can be a blank file-->
<!--                       </p>-->

<!--                </div>-->
<!--            </div>-->
<!--            <div class="columns is-centered">-->
<!--                <div class="column is-three-quarters has-text-centered">-->
<!--                    <h3 class="benefits_heading is-size-3-mobile">Part 6: Exploring an (optional) setup.py  file:  </h3>-->
<!--                    <p> This file (or either requirements.txt or pyproject file) is where you add any requirements-->
<!--                        that your model needs, in the requirements dictionary on lines 6-7 if using a setup.py. If your model-->
<!--                        had any extra requirements, such as a specific version of a package or an external git-->
<!--                        repository, you would add it to the list defined on line 6. Lines 9 - 24 are just-->
<!--                        administrative definitions, and can be left untouched. This file is completely optional, and-->
<!--                        can be excluded if your model needs no extra packages.-->
<!--                   </p>-->
<!--                </div>-->
<!--            </div>-->
<!--            <div class="columns is-centered">-->
<!--                <div class="column is-three-quarters has-text-centered">-->
<!--                    <h3 class="benefits_heading is-size-3-mobile">Part 7: Exploring another optional file: model.py!</h3>-->
<!--                    <p> This is usually where the model itself if defined as well as added into the Brain-Score-->
<!--                        ecosystem. The reason why this is optional is that using model.py is a convention we use to-->
<!--                        separate code, but that is not needed. It is also plugin-specific. We think it is good practice,-->
<!--                        however, to use a separate model.py for models, to keep things neat.-->
<!--                    </p>-->
<!--                    <br>-->
<!--                    <p> Let’s explore this file in more-->
<!--                        detail: Lines 1 - 9 are standard imports. Lines-->
<!--                        20-21 define the get_model_list() function that simply returns the model identifier.-->
<!--                        Next, Lines 24-48 define the get_model() function that gets the model itself.-->
<!--                        You can see on line 26 the model itself is being loaded from pytorch. If you have a custom-->
<!--                        model that you have created yourself, check out our Custom Model Submission Guide here in-->
<!--                        Deep Dive 2 Lines 41 - 43 contain the get_layers() function, which returns the layers you-->
<!--                        are interested in scoring.-->
<!--                    </p>-->
<!--                    <br>-->
<!--                    <p> Lines 46 and 47 define the Bibtex for the model. You can leave this blank when submitting,-->
<!--                        but we highly recommend you add a reference. Finally, lines 80 - 83 defines a call to the-->
<!--                        Brain-Score scoring system to score our model locally on a mock benchmark.-->
<!--                    </p>-->
<!--                </div>-->
<!--            </div>-->

<!--            <div class="columns is-centered">-->
<!--                <div class="column is-three-quarters has-text-centered">-->
<!--                    <h3 class="benefits_heading is-size-3-mobile">Part 8: Putting it all together </h3>-->
<!--                    <p> If you were actually submitting a model, the final step would be to run your model locally,-->
<!--                        to ensure that everything is in working order. Let’s open up our model.py folder,-->
<!--                        and run the file itself. Once ran, this should produce the message below, indicating-->
<!--                        that you are ready for submission:-->
<!--                    </p>-->
<!--                    <br><pre>-->
<!--                    <code class="language-python">-->
<!--                    Test successful, you are ready to submit!-->
<!--                    </code>-->
<!--                    </pre><br>-->
<!--                    <p> Once you receive this message, you could rezip-->
<!--                        (after you save everything, of course) our sample model.zip file,-->
<!--                        and you would be good to submit your model.-->
<!--                        <strong>-->
<!--                            Again, please do NOT actually submit the-->
<!--                            model that you just explored during this entire tutorial. This process was for illustration purposes only.-->
<!--                        </strong>-->
<!--                        <br>-->
<!--                        When you submit an actual (non-tutorial) model, you will receive an email with your results-->
<!--                        within 24 hours. (Most of the time it only takes 2-3 hours to score).-->
<!--                        If you would like to know how to submit a custom model to Brain-Score, please visit the next-->
<!--                        deepdive <a href="https://www.brain-score.org/tutorial/deepdive_2">here</a>.-->
<!--                       </p>-->
<!--                </div>-->
<!--            </div>-->
<!--        </div>-->
<!--    </section>-->
<!--</div>-->
{% endblock %}-->


