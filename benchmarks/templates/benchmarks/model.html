{% extends 'benchmarks/base.html' %}

{% block content %}

    <section class="individual_model container center">
        <h1 class="title">{{ model.name }}</h1>
        {% if model.reference_identifier %}
            <a href="{{ model.reference_link }}">{{ model.reference_identifier }}</a>
        {% else %}
            <p class="no_reference">No reference paper on file</p>
        {% endif %}

        {# Benchmark scores #}
        <h2 id="scores" class="title-is-2">Benchmark scores</h2>
        <div class="benchmark_scores">
            {% for score_row in model.scores %}
                {% if score_row.score_ceiled %}
                    <div class="benchmark_child_{{ score_row.benchmark.depth }}
                            {% if score_row.benchmark.children|length == 0 %} box {% endif %}">
                        <table class="benchmarks">
                            <tr class="list_entry">
                                <td title="unceiled score: {{ score_row.score_raw }}"
                                    data-benchmark="{{ score_row.benchmark_specifier }}"
                                    data-parent="{{ benchmark_parents|get_parent_item:score_row.benchmark_specifier }}"
                                    class="score_cell displaySquare depth_{{ score_row.benchmark.depth }} clicker"
                                    style="{{ score_row.color }}; ">
                                    {{ score_row.score_ceiled }}
                                </td>
                                <td class="benchmark_identifier">
                                    {{ score_row.benchmark.short_name }}
                                    <br/>
                                    {% if score_row.rank %}
                                        <span class="tag top_indicator">rank {{ score_row.rank }}</span>
                                    {% else %}
                                        <span></span>  {# empty span to guarantee benchmark name at top #}
                                    {% endif %}
                                </td>
                            </tr>
                            <tr>
                                <td></td>
                                <td>
                                    {% if score_row.benchmark.children|length == 0 %}
                                        <div class="benchmark_info">
                                            {% if score_row.benchmark.meta %}
                                                <span>
                                                    {% if score_row.benchmark.meta.number_of_recording_sites %}
                                                        recordings from
                                                        {{ score_row.benchmark.meta.number_of_recording_sites }}
                                                        sites in
                                                        {{ score_row.benchmark.meta.recording_sites }}
                                                    {% endif %}
                                                    {% if score_row.benchmark.meta.behavioral_task %}
                                                        {{ score_row.benchmark.meta.behavioral_task }} task
                                                    {% endif %}
                                                </span>
                                                <br/>
                                                {% if score_row.benchmark.meta.number_of_images %}
                                                    <span>{{ score_row.benchmark.meta.number_of_images }} images</span>
                                                    <br/>
                                                {% endif %}
                                            {% endif %}
                                            {# image samples #}
                                            <div class="samples_container is-overflow-wrap">
                                                {% for sample in '0123456789'|make_list %}
                                                    <img class="stimulus_sample"
                                                         src="/static/benchmarks/img/benchmark_samples/{{ score_row.benchmark_specifier }}/{{ sample }}.png"
                                                         alt="sample {{ sample }}"/>
                                                {% endfor %}
                                            </div>
                                        </div>
                                    {% endif %}
                                </td>
                            </tr>
                        </table>
                    </div>
                {% endif %}
            {% endfor %}
        </div>


        {# BrainModel info #}
        <h2 id="brainmodel" class="title-is-2">BrainModel translation</h2>
        <div>
            <div class="notification is-info is-light">
                explanation of brain model...
            </div>

            {# visual degrees #}
            <div id="visual_degrees" class="box">
                <h3 id="visual_degrees" class="subtitle-is-3">degrees visual angle: {{ visual_degrees }}</h3>
                <div class="notification is-info is-light">
                    Models have to declare their field-of-view so that stimuli can be displayed like they were displayed
                    to experimental subjects.
                    For instance, if experimental stimuli were shown at 4 degrees and a model's field-of-view is larger
                    than that, then the stimuli are padded such that the core stimulus will make up 4 degrees in the
                    model's field-of-view.
                </div>

                <div class="columns">
                    <div class="column">
                        <p class="has-text-centered">base image presented at 8 degrees</p>
                        <figure class="image is-marginless is-256x256">
                            <img src="/static/benchmarks/img/visual_degrees/{{ visual_degrees }}_to_8.png"
                                 alt="visual degrees {{ visual_degrees }} to 8"/>
                        </figure>
                    </div>

                    <div class="column">
                        <p class="has-text-centered">if benchmark presents image at 4 degrees, model sees</p>
                        <figure class="image is-marginless is-256x256">
                            <img src="/static/benchmarks/img/visual_degrees/{{ visual_degrees }}_to_4.png"
                                 alt="visual degrees {{ visual_degrees }} to 4"/>
                        </figure>
                    </div>

                    <div class="column">
                        <p class="has-text-centered">if benchmark presents image at 12 degrees, model sees</p>
                        <figure class="image is-marginless is-256x256">
                            <img src="/static/benchmarks/img/visual_degrees/{{ visual_degrees }}_to_12.png"
                                 alt="visual degrees {{ visual_degrees }} to 12"/>
                        </figure>
                    </div>
                </div>
            </div>

            {# region-layer commitment #}
            <div class="box">
                <h3 id="region_layer_commitment" class="subtitle-is-3">layer commitment</h3>
                <div class="notification is-info is-light">
                    explanation
                </div>

                {% if layers %}
                    <table class="table">
                        <thead>
                        <tr>
                            <th>Region</th>
                            <th>Layer</th>
                        </tr>
                        </thead>
                        <tbody>
                        {% for region, layer in layers.items %}
                            <tr>
                                <th>{{ region }}</th>
                                <td>{{ layer }}</td>
                            </tr>
                        {% endfor %}
                        </tbody>
                    </table>
                {% else %}
                    No layer commitments found for this model. Older submissions might not have stored this information
                    but will be updated when being evaluated on new benchmarks.
                {% endif %}
            </div>
        </div>
    </section>

{% endblock %}
